<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.wizian.cbb.consulting.dao.IConsultingRepository">
	<!--//////////////상담 항목 관리////////////////////// -->
	<resultMap id="selectConsulting"
		type="com.wizian.cbb.consulting.model.ConItemVO">
		<result property="itemID" column="DSCSN_TTL_SN" />
		<result property="item" column="DSCSN_TTL" />
		<result property="use" column="USE_YN" />
		<result property="creationDate" column="CRT_YMD" />
		<result property="modificationDate" column="MDFCN_YMD" />
	</resultMap>

	<select id="Consultationitems" resultMap="selectConsulting">
		SELECT * FROM
		DSCSN_TTL
	</select>

	<insert id="itemInsert">
		INSERT INTO DSCSN_TTL (
		DSCSN_TTL_SN,
		DSCSN_TTL,
		USE_YN
		) VALUES (
		#{itemID},
		#{item},
		#{use}
		)
	</insert>

	<update id="itemUpdate">
		UPDATE DSCSN_TTL
		SET DSCSN_TTL = #{item},
		USE_YN =
		#{use}
		WHERE DSCSN_TTL_SN = #{itemID}
	</update>

	<delete id="itemDelete" parameterType="string">
		DELETE FROM DSCSN_TTL
		WHERE DSCSN_TTL_SN = #{itemId}
	</delete>

	<select id="itemCheck" resultType="string">
		SELECT DSCSN_TTL_SN FROM
		DSCSN_TTL WHERE DSCSN_TTL_SN = #{itemID}
	</select>
	<!--//////////////상담 항목 관리////////////////////// -->





	<!--//////////////상담원 시간표 확인////////////////////// -->
	<resultMap id="scheduleList"
		type="com.wizian.cbb.consulting.model.SchedulePrintVO">
		<result property="type" column="type" />
		<result property="counselor" column="counselor" />
		<result property="item" column="item" />
		<result property="consultationDate" column="consultationDate" />
		<result property="consultationTime" column="consultationTime" />
		<result property="creationDate" column="creationDate" />
	</resultMap>
	<select id="adminScheduleList" resultMap="scheduleList">
		SELECT
		c.COUNSELOR_TYPE
		AS
		TYPE,
		c.CNSLR_NM AS counselor,
		c.ARSP_NM AS ITEM,
		t.TIMETBL AS
		consultationTime,
		s.DSCSN_DT_YMD AS consultationDate,
		s.DSCSN_REG_YMD AS
		creationDate
		FROM
		CNSL_SCHEDULE s
		JOIN
		COUNSELOR c ON s.CNSL_SN =
		c.CNSL_SN
		JOIN
		TIMETBL t ON s.TIMETBL_CD = t.TIMETBL_CD
	</select>


	<select id="checkId" resultType="string">
		SELECT CNSL_SN FROM COUNSELOR
		WHERE
		USER_ID = #{id}
	</select>

	<select id="checkDuplicate" resultType="boolean">
		SELECT COUNT(*) FROM
		CNSL_SCHEDULE
		WHERE CNSL_SN = #{id} AND TIMETBL_CD = #{cdNum} AND
		DSCSN_DT_YMD =
		#{strDate}
	</select>


	<insert id="insertSchedule">
		INSERT INTO CNSL_SCHEDULE
		(CNSL_SCHEDULE_SN, CNSL_SN,
		TIMETBL_CD,
		DSCSN_DT_YMD, DSCSN_REG_YMD)
		VALUES (schedule_seq.NEXTVAL,
		#{id}, #{cdNum}, #{strDate}, SYSDATE)
	</insert>
	<!--//////////////상담원 시간표 확인////////////////////// -->









	<!--//////////////학생 상담 종합 이력////////////////////// -->
	<resultMap id="resultList"
		type="com.wizian.cbb.consulting.model.ResultVO">
		<result property="type" column="COUNSELOR_TYPE" />
		<result property="counselor" column="CNSLR_NM" />
		<result property="item" column="DSCSN_TTL" />
		<result property="student" column="STDNT_NM" />
		<result property="content" column="PRCS_RSLT_CN" />
		<result property="consultationDate" column="DSCSN_DT_YMD" />
		<result property="creationDate" column="RSLT_REG_YMD" />
		<result property="time" column="TIMETBL" />
	</resultMap>

	<select id="resultList" resultMap="resultList">
		SELECT
		C.COUNSELOR_TYPE,
		C.CNSLR_NM,
		D.DSCSN_TTL,
		B.DSCSN_DT_YMD,
		E.STDNT_NM,
		F.PRCS_RSLT_CN,
		F.RSLT_REG_YMD,
		G.TIMETBL
		FROM
		DSCSN_RSVT A
		JOIN CNSL_SCHEDULE B ON
		A.CNSL_SCHEDULE_SN = B.CNSL_SCHEDULE_SN
		JOIN COUNSELOR C ON B.CNSL_SN =
		C.CNSL_SN
		JOIN DSCSN_TTL D ON A.DSCSN_TTL_SN = D.DSCSN_TTL_SN
		JOIN STDNT
		E ON A.STDNT_SN = E.STDNT_SN
		JOIN DSCSN_RSLT_CN F ON A.DSCSN_RSVT_SN =
		F.DSCSN_RSVT_SN
		JOIN TIMETBL G ON B.TIMETBL_CD = G.TIMETBL_CD
	</select>
	<!--//////////////학생 상담 종합 이력////////////////////// -->


	<!--//////////////학생 상담 신청////////////////////// -->
	<resultMap id="counselorList"
		type="com.wizian.cbb.consulting.model.ConuselorVO">
		<result property="sonuselorId" column="CNSL_SN" />
		<result property="name" column="CNSLR_NM" />
		<result property="phone" column="MBL_TELNO" />
		<result property="email" column="EML_ADDR" />
		<result property="birth" column="BRDT" />
		<result property="address" column="RLRSD_ADDR" />
		<result property="item" column="ARSP_NM" />
		<result property="type" column="COUNSELOR_TYPE" />
		<result property="gender" column="GNDR_NM" />
		<result property="userNum" column="USER_NO" />
	</resultMap>
	
	<select id="counselorList" resultMap="counselorList">
		SELECT * FROM COUNSELOR
	</select>


	<!--//////////////학생 상담 신청////////////////////// -->
</mapper>